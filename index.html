
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Total Home Energy Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: #f4f7f6; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; }
        .card { background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 30px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 20px; }
        h2 { color: #34495e; font-size: 1.2em; border-bottom: 2px solid #ecf0f1; padding-bottom: 10px; margin-top: 0; }
        .chart-container { position: relative; height: 300px; width: 100%; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Total Home Energy Dashboard</h1>

        <!-- 1. Total Energy Cost (Gas + Electric + Solar) -->
        <div class="card">
            <h2>üí∞ Total Energy Wallet (Where is the money going?)</h2>
            <div class="chart-container">
                <canvas id="totalCostChart"></canvas>
            </div>
        </div>

        <!-- 2. Total Energy Consumption (kWh Equivalent) -->
        <div class="card">
            <h2>‚ö° Total Energy Consumed (Gas vs Electric)</h2>
            <div class="chart-container">
                <canvas id="totalEnergyChart"></canvas>
            </div>
            <p style="text-align: center; font-size: 0.9em; color: #666; margin-top: 10px;">
                * Gas converted to kWh using 1 Therm = 29.3 kWh
            </p>
        </div>

        <!-- 3. Total Home Consumption (Electric Only) -->
        <div class="card">
            <h2>üè† Home Electric Consumption</h2>
            <div style="text-align: right; margin-bottom: 10px;">
                <button id="toggleConsumptionBtn" style="padding: 8px 16px; background: #34495e; color: white; border: none; border-radius: 4px; cursor: pointer;">Switch to Area Chart</button>
            </div>
            <div class="chart-container">
                <canvas id="consumptionChart"></canvas>
            </div>
            <p style="text-align: center; font-size: 0.9em; color: #666;">
                <strong>Blue:</strong> Power bought from Grid. <strong>Green:</strong> Solar power used directly. 
                <br>The total height is your real home usage.
            </p>
        </div>

        <div class="grid">
            <!-- 2. Net Zero Tracker -->
            <div class="card">
                <h2>‚öñÔ∏è Net Zero Tracker</h2>
                <div class="chart-container">
                    <canvas id="netZeroChart"></canvas>
                </div>
            </div>

            <!-- 3. Credit Bank -->
            <div class="card">
                <h2>üí∞ National Grid Credit Bank</h2>
                <div class="chart-container">
                    <canvas id="creditChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- 4. Monthly Electric Costs (Grid + Solar) -->
            <div class="card">
                <h2>üíµ Monthly Electric Costs (Grid + Solar)</h2>
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>

            <!-- 5. Effective Rate -->
            <div class="card">
                <h2>üìâ Effective Cost per kWh</h2>
                <div class="chart-container">
                    <canvas id="rateChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- 6. Solar Utilization -->
        <div class="card">
            <h2>‚òÄÔ∏è Solar Utilization (Where did the power go?)</h2>
            <div class="chart-container">
                <canvas id="utilizationChart"></canvas>
            </div>
        </div>

    </div>

    <script>
        const labels = ["2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02","2023-03","2023-04","2023-05","2023-06","2023-07","2023-08","2023-09","2023-10","2023-11","2023-12","2024-01","2024-02","2024-03","2024-04","2024-05","2024-06","2024-07","2024-08","2024-09","2024-10","2024-11","2024-12","2025-01","2025-02","2025-03","2025-04","2025-05","2025-06","2025-07","2025-08","2025-09","2025-10","2025-11"];
        
        // Common Options
        const commonOptions = {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { mode: 'index', intersect: false },
        };

        const currencyOptions = {
            ...commonOptions,
            scales: {
                y: {
                    ticks: {
                        callback: function(value) { return '$' + value; }
                    }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                            }
                            return label;
                        }
                    }
                }
            }
        };

        const kwhOptions = {
            ...commonOptions,
            scales: {
                y: {
                    ticks: {
                        callback: function(value) { return value + ' kWh'; }
                    }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y + ' kWh';
                            }
                            return label;
                        }
                    }
                }
            }
        };

        // 1. Consumption Chart (Stacked)
        // 1. Total Energy Cost Chart
        new Chart(document.getElementById('totalCostChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Gas Bill',
                        data: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,388.32,248.74,107.45,62.33,51.09,44.08,42.7,48.25,62.1,256.07,302.11,439.29,253.41,35.98,39.37,36.63,65.64,96.06,27.19,32.65,27.19,35.82,47.75,56.64,57.07,52.39,54.5,41.94,41.94,44.23,46.53,60.25,55.01,0],
                        backgroundColor: '#e74c3c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Electric Bill',
                        data: [205.71,134.52,200.24,317.52,231.48,262.76,170.06,202.24,264.24,395.86,229.9,20.38,0,0,0,116.73,0,0,16.8,57.98,152.13,0,0,0,0,0,0,0,0,0,0,44.74,55.6,73.74,404.75,0,0,0,37.89,125.29,79.21,120.33,168.16,528.25,931.59,859.55,347.19,26,0,0,34.78,16.43,51.63,121.27,124.85],
                        backgroundColor: '#3498db',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Solar Bill',
                        data: [0,0,0,0,0,0,0,0,0,0,0,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,153.28,153.28,153.28,153.28,153.28,153.28,153.28,153.28],
                        backgroundColor: '#f1c40f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Total Spend',
                        data: [205.71,134.52,200.24,317.52,231.48,262.76,170.06,202.24,264.24,395.86,229.9,161.06,140.68,140.68,140.68,257.41,140.68,140.68,157.48000000000002,198.66,292.81,529,389.42,252.20999999999998,207.08999999999997,195.85,188.83999999999997,187.45999999999998,193.01,206.85999999999999,400.83,491.61,639.65,471.90999999999997,585.49,188.33,185.59,214.60000000000002,282.91,301.44,260.82,296.48,352.94,724.96,1137.19,1065.58,548.54,233.78,195.22,195.22,232.29,216.24,265.15999999999997,329.56,278.13],
                        type: 'line',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: currencyOptions
        });

        // 2. Total Energy Consumption Chart (kWh)
        new Chart(document.getElementById('totalEnergyChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Gas (kWh equiv)',
                        data: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5332.6,4189.900000000001,1699.4,1025.5,820.4,673.9,644.6,761.8000000000001,1054.8,4043.4,4775.900000000001,7325,4160.6,410.2,468.8,498.1,351.6,380.90000000000003,322.3,439.5,322.3,322.3,468.8,586,556.7,556.7,586,380.90000000000003,380.90000000000003,410.2,439.5,615.3000000000001,586,644.6],
                        backgroundColor: '#e74c3c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Electric Consumed',
                        data: [751,512,833,1322,955,1088,694,766,898,1331,781,721,621,498,855,1774,880,513,547,437,915,407,465,376,319,332,936,983,878,534,425,500,488,504,2548,496,279,475,1651,1503,1324,1006,1078,1924,3054,2830,2193,1020,952,1137,1427,1427,1266,1255,940],
                        backgroundColor: '#3498db',
                        stack: 'Stack 0'
                    }
                ]
            },
            options: kwhOptions
        });

        // 3. Consumption Chart (Toggleable)
        let consumptionChart = null;
        let isAreaChart = false;

        function createConsumptionChart() {
            const ctx = document.getElementById('consumptionChart').getContext('2d');
            if (consumptionChart) consumptionChart.destroy();

            const type = isAreaChart ? 'line' : 'bar';
            const fill = isAreaChart ? true : false;
            
            consumptionChart = new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Imported from Grid',
                            data: [751,512,833,1322,955,1088,694,766,898,1331,781,0,0,0,0,410,0,0,23,105,286,0,0,0,0,0,0,0,0,0,0,99,134,191,1104,0,0,0,57,318,193,324,461,1509,2692,2530,1471,280,0,0,92,13,164,455,499],
                            backgroundColor: isAreaChart ? 'rgba(52, 152, 219, 0.5)' : '#3498db',
                            borderColor: '#3498db',
                            fill: fill,
                            stack: 'Stack 0'
                        },
                        {
                            label: 'Solar Self-Use',
                            data: [0,0,0,0,0,0,0,0,0,0,0,721,621,498,855,1364,880,513,524,332,629,407,465,376,319,332,936,983,878,534,425,401,354,313,1444,496,279,475,1594,1185,1131,682,617,415,362,300,722,740,952,1137,1335,1414,1102,800,441],
                            backgroundColor: isAreaChart ? 'rgba(46, 204, 113, 0.5)' : '#2ecc71',
                            borderColor: '#2ecc71',
                            fill: fill,
                            stack: 'Stack 0'
                        },
                        {
                            label: 'Total Consumption',
                            data: [751,512,833,1322,955,1088,694,766,898,1331,781,721,621,498,855,1774,880,513,547,437,915,407,465,376,319,332,936,983,878,534,425,500,488,504,2548,496,279,475,1651,1503,1324,1006,1078,1924,3054,2830,2193,1020,952,1137,1427,1427,1266,1255,940],
                            type: 'line',
                            borderColor: '#34495e',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            tension: 0.3,
                            pointRadius: 0
                        }
                    ]
                },
                options: kwhOptions
            });
        }

        // Initial Render
        createConsumptionChart();

        // Toggle Handler
        document.getElementById('toggleConsumptionBtn').addEventListener('click', function() {
            isAreaChart = !isAreaChart;
            this.textContent = isAreaChart ? 'Switch to Bar Chart' : 'Switch to Area Chart';
            createConsumptionChart();
        });

        // 2. Net Zero Tracker
        new Chart(document.getElementById('netZeroChart'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Solar Production',
                        data: [0,0,0,0,0,0,0,0,0,0,0,760,1223,1528,1488,1364,961,579,524,332,629,407,547,1010,977,1538,1249,1177,970,983,425,401,354,313,1444,1188,279,1439,1594,1185,1131,682,617,415,362,300,722,740,1374,1224,1335,1414,1102,800,441],
                        borderColor: '#f1c40f',
                        backgroundColor: 'rgba(241, 196, 15, 0.1)',
                        fill: true,
                        tension: 0.3
                    },
                    {
                        label: 'True Consumption',
                        data: [751,512,833,1322,955,1088,694,766,898,1331,781,721,621,498,855,1774,880,513,547,437,915,407,465,376,319,332,936,983,878,534,425,500,488,504,2548,496,279,475,1651,1503,1324,1006,1078,1924,3054,2830,2193,1020,952,1137,1427,1427,1266,1255,940],
                        borderColor: '#34495e',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: kwhOptions
        });

        // 3. Credit Bank
        new Chart(document.getElementById('creditChart'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Credit Balance ($)',
                        data: [0,0,0,0,0,0,0,0,0,0,0,0,139.65,366.18,500.66,383.93,392.29,398.77,381.97,323.99,171.86,0,200.36,481.51,718.34,1023.37,1091.61,1125.33,1133.65,1236,0,1191.26,1135.66,1061.92,762.11,865.96,0,1161.3,1123.41,998.12,918.91,798.58,630.42,102.17,0,0,512.36,486.36,598.66,612.27,577.49,561.06,509.43,388.16,263.31],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        fill: true,
                        tension: 0.3
                    }
                ]
            },
            options: currencyOptions
        });

        // 4. Cost Chart
        new Chart(document.getElementById('costChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'National Grid',
                        data: [205.71,134.52,200.24,317.52,231.48,262.76,170.06,202.24,264.24,395.86,229.9,20.38,0,0,0,116.73,0,0,16.8,57.98,152.13,0,0,0,0,0,0,0,0,0,0,44.74,55.6,73.74,404.75,0,0,0,37.89,125.29,79.21,120.33,168.16,528.25,931.59,859.55,347.19,26,0,0,34.78,16.43,51.63,121.27,124.85],
                        backgroundColor: '#3498db',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Sunrun',
                        data: [0,0,0,0,0,0,0,0,0,0,0,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,140.68,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,148.96,153.28,153.28,153.28,153.28,153.28,153.28,153.28,153.28],
                        backgroundColor: '#f1c40f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Total',
                        data: [205.71,134.52,200.24,317.52,231.48,262.76,170.06,202.24,264.24,395.86,229.9,161.06,140.68,140.68,140.68,257.41,140.68,140.68,157.48000000000002,198.66,292.81,140.68,140.68,144.76,144.76,144.76,144.76,144.76,144.76,144.76,144.76,189.5,200.35999999999999,218.5,549.51,148.96,148.96,148.96,186.85000000000002,274.25,228.17000000000002,269.29,317.12,677.21,1080.55,1008.51,496.15,179.28,153.28,153.28,188.06,169.71,204.91,274.55,278.13],
                        type: 'line',
                        borderColor: '#e74c3c',
                        borderWidth: 2,
                        fill: false
                    }
                ]
            },
            options: currencyOptions
        });

        // 5. Rate Chart
        new Chart(document.getElementById('rateChart'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Effective $/kWh',
                        data: [0.27391478029294275,0.262734375,0.2403841536614646,0.24018154311649015,0.2423874345549738,0.24150735294117645,0.24504322766570605,0.26402088772845955,0.2942538975501114,0.29741547708489857,0.2943661971830986,0.22338418862690707,0.2265378421900161,0.28248995983935743,0.16453801169590643,0.14510146561443069,0.15986363636363637,0.2742300194931774,0.2878976234003657,0.4545995423340961,0.32001092896174865,0.3456511056511057,0.30253763440860215,0.38499999999999995,0.45379310344827584,0.4360240963855421,0.15465811965811965,0.14726347914547303,0.164874715261959,0.2710861423220974,0.34061176470588234,0.379,0.41057377049180327,0.43353174603174605,0.21566326530612245,0.3003225806451613,0.5339068100358423,0.3136,0.11317383403997579,0.18246839654025282,0.17233383685800605,0.26768389662027836,0.2941743970315399,0.3519802494802495,0.35381466928618205,0.35636395759717315,0.22624259005927952,0.17576470588235293,0.16100840336134453,0.1348109058927001,0.13178696566222844,0.11892782060266294,0.1618562401263823,0.21876494023904383,0.29588297872340424],
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        fill: true,
                        tension: 0.3
                    }
                ]
            },
            options: {
                ...commonOptions,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: '$/kWh' }
                    }
                }
            }
        });

        // 6. Utilization Chart
        new Chart(document.getElementById('utilizationChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Used at Home',
                        data: [0,0,0,0,0,0,0,0,0,0,0,721,621,498,855,1364,880,513,524,332,629,407,465,376,319,332,936,983,878,534,425,401,354,313,1444,496,279,475,1594,1185,1131,682,617,415,362,300,722,740,952,1137,1335,1414,1102,800,441],
                        backgroundColor: '#2ecc71',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Sent to Grid',
                        data: [0,0,0,0,0,0,0,0,0,0,0,39,602,1030,633,0,81,66,0,0,0,0,82,634,658,1206,313,194,92,449,0,0,0,0,0,692,0,964,0,0,0,0,0,0,0,0,0,0,422,87,0,0,0,0,0],
                        backgroundColor: '#95a5a6',
                        stack: 'Stack 0'
                    }
                ]
            },
            options: kwhOptions
        });
    </script>
</body>
</html>
    